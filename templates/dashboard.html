{% extends "base.html" %}

{% block content %}
<div class="app-layout">
    <!-- Sidebar -->
    <aside class="sidebar {{ 'sidebar-right' if is_rtl else 'sidebar-left' }}">
        <!-- Brand with Logo -->
        <div class="sidebar-brand">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Mizan Logo" class="sidebar-logo">
        </div>
        
        <!-- Language Toggle -->
        <div class="sidebar-lang">
            <a href="{{ url_for('dashboard', lang='en') }}" class="lang-btn {{ 'active' if lang == 'en' else '' }}">EN</a>
            <a href="{{ url_for('dashboard', lang='ar') }}" class="lang-btn {{ 'active' if lang == 'ar' else '' }}">ع</a>
        </div>
        
        <!-- User Info -->
        <div class="user-info">
            <div class="user-avatar">
                <i class="fas fa-user"></i>
            </div>
            <div class="user-details">
                <span class="user-label">{{ txt.logged_in_as }}</span>
                <span class="user-name">{{ username }}</span>
                {% if session.get('role') == 'admin' %}
                <a href="{{ url_for('admin_dashboard') }}" class="admin-link"><i class="fas fa-crown"></i> Admin</a>
                {% endif %}
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="sidebar-nav">
            {% for domain in domains %}
            <a href="{{ url_for('domain_page', domain_name=domain, lang=lang) }}" class="nav-item">
                {% if 'Cyber' in domain or 'سيبراني' in domain %}
                <i class="fas fa-shield-alt"></i>
                {% elif 'Data' in domain or 'بيانات' in domain %}
                <i class="fas fa-database"></i>
                {% elif 'AI' in domain or 'ذكاء' in domain %}
                <i class="fas fa-robot"></i>
                {% elif 'Digital' in domain or 'رقمي' in domain %}
                <i class="fas fa-digital-tachograph"></i>
                {% else %}
                <i class="fas fa-globe"></i>
                {% endif %}
                <span>{{ domain }}</span>
            </a>
            {% endfor %}
            
            <!-- Document History Link -->
            <a href="{{ url_for('document_history', lang=lang) }}" class="nav-item nav-history">
                <i class="fas fa-folder-open"></i>
                <span>{{ txt.my_documents }}</span>
            </a>
        </nav>
        
        <!-- Settings -->
        <div class="sidebar-settings">
            <button class="settings-btn" onclick="toggleSettings()">
                <i class="fas fa-cog"></i> {{ txt.settings }}
            </button>
            <div class="settings-menu hidden" id="settings-menu">
                <button onclick="clearHistory()" class="settings-item">
                    <i class="fas fa-trash"></i> {{ txt.clear_history }}
                </button>
            </div>
        </div>
        
        <!-- AI Status -->
        <div class="ai-status {{ 'connected' if ai_available else 'disconnected' }}">
            <div class="status-dot"></div>
            <span>{{ txt.ai_connected if ai_available else txt.ai_disconnected }}</span>
        </div>
        
        <!-- Logout -->
        <a href="{{ url_for('logout') }}" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i> {{ txt.logout }}
        </a>
        
        <!-- Creator -->
        <div class="sidebar-footer">
            <p class="created-by">{{ txt.created_by }}</p>
            <p class="creator-name">{{ config.CREATOR_NAME }}</p>
            <p class="copyright">© {{ config.COPYRIGHT_YEAR }}</p>
        </div>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="main-header">
            <h1>
                <span class="header-icon">⚖️</span>
                {{ txt.app_name }}
            </h1>
            <p class="header-tagline">{{ txt.tagline }}</p>
        </header>
        
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-chess"></i></div>
                <div class="stat-value">{{ stats.strategies }}</div>
                <div class="stat-label">{{ txt.tabs[0] }}</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                <div class="stat-value">{{ stats.policies }}</div>
                <div class="stat-label">{{ txt.tabs[1] }}</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                <div class="stat-value">{{ stats.risks }}</div>
                <div class="stat-label">{{ txt.tabs[3] }}</div>
            </div>
        </div>
        
        <!-- Domain Cards -->
        <h2 class="section-title">
            <i class="fas fa-th-large"></i>
            {% if is_rtl %}اختر المجال{% else %}Select Domain{% endif %}
        </h2>
        
        <div class="domain-grid">
            {% for domain in domains %}
            <a href="{{ url_for('domain_page', domain_name=domain, lang=lang) }}" class="domain-card">
                <div class="domain-icon">
                    {% if 'Cyber' in domain or 'سيبراني' in domain %}
                    <i class="fas fa-shield-alt"></i>
                    {% elif 'Data' in domain or 'بيانات' in domain %}
                    <i class="fas fa-database"></i>
                    {% elif 'AI' in domain or 'ذكاء' in domain %}
                    <i class="fas fa-robot"></i>
                    {% elif 'Digital' in domain or 'رقمي' in domain %}
                    <i class="fas fa-digital-tachograph"></i>
                    {% else %}
                    <i class="fas fa-globe"></i>
                    {% endif %}
                </div>
                <h3 class="domain-name">{{ domain }}</h3>
                <p class="domain-desc">
                    {% if is_rtl %}
                    انقر للدخول إلى أدوات {{ domain }}
                    {% else %}
                    Click to access {{ domain }} tools
                    {% endif %}
                </p>
                <div class="domain-arrow">
                    <i class="fas fa-arrow-{{ 'left' if is_rtl else 'right' }}"></i>
                </div>
            </a>
            {% endfor %}
        </div>
    </main>
</div>

<script>
function toggleSettings() {
    document.getElementById('settings-menu').classList.toggle('hidden');
}

function clearHistory() {
    if (confirm('Are you sure you want to clear all history?')) {
        // API call to clear history
        alert('History cleared!');
    }
}
</script>
{% endblock %}
